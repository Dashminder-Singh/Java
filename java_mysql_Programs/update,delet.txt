package hardware_shop;

import java.sql.*;
import javax.swing.JOptionPane;


public class update_product extends javax.swing.JInternalFrame implements myvariables{

 /**
 * Creates new form newstock
 */
 public update_product() {
 initComponents();
 
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="select * from categorytable";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 ResultSet myresult=mystatement.executeQuery();
 
 if(myresult.next())
 {
 do
 {
 categorybox.addItem(myresult.getString("categoryname"));
 }
 while(myresult.next());
 
 }
 else
 {
 JOptionPane.showMessageDialog(rootPane,"No Categories exist");
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 
 
 
 
 
 }

 /**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
 @SuppressWarnings("unchecked")
 // <editor-fold defaultstate="collapsed" desc="Generated Code"> 
 private void initComponents() {

 jLabel2 = new javax.swing.JLabel();
 productidbox = new javax.swing.JTextField();
 jButton1 = new javax.swing.JButton();
 jLabel3 = new javax.swing.JLabel();
 categorybox = new javax.swing.JComboBox<>();
 subcategorybox = new javax.swing.JComboBox<>();
 jLabel1 = new javax.swing.JLabel();
 productnamebox = new javax.swing.JTextField();
 jLabel4 = new javax.swing.JLabel();
 jLabel5 = new javax.swing.JLabel();
 jLabel6 = new javax.swing.JLabel();
 jLabel7 = new javax.swing.JLabel();
 pricebox = new javax.swing.JFormattedTextField();
 qtybox = new javax.swing.JFormattedTextField();
 sizebox = new javax.swing.JTextField();
 jButton2 = new javax.swing.JButton();
 jButton3 = new javax.swing.JButton();

 setClosable(true);
 setIconifiable(true);
 setTitle("Update Product");

 jLabel2.setText("Category Name");

 jButton1.setText("Update");
 jButton1.addActionListener(new java.awt.event.ActionListener() {
 public void actionPerformed(java.awt.event.ActionEvent evt) {
 jButton1ActionPerformed(evt);
 }
 });

 jLabel3.setText("Sub Category Name");

 categorybox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Choose Category" }));
 categorybox.addActionListener(new java.awt.event.ActionListener() {
 public void actionPerformed(java.awt.event.ActionEvent evt) {
 categoryboxActionPerformed(evt);
 }
 });

 subcategorybox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Choose Category first" }));

 jLabel1.setText("Product ID");

 jLabel4.setText("Product Name");

 jLabel5.setText("Price");

 jLabel6.setText("Qty");

 jLabel7.setText("Size");

 pricebox.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));

 qtybox.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));

 jButton2.setText("Search");
 jButton2.addActionListener(new java.awt.event.ActionListener() {
 public void actionPerformed(java.awt.event.ActionEvent evt) {
 jButton2ActionPerformed(evt);
 }
 });

 jButton3.setText("Delete");
 jButton3.addActionListener(new java.awt.event.ActionListener() {
 public void actionPerformed(java.awt.event.ActionEvent evt) {
 jButton3ActionPerformed(evt);
 }
 });

 javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
 getContentPane().setLayout(layout);
 layout.setHorizontalGroup(
 layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(layout.createSequentialGroup()
 .addGap(92, 92, 92)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addComponent(jLabel3)
 .addComponent(jLabel2)
 .addComponent(jLabel1)
 .addComponent(jLabel4)
 .addComponent(jLabel7)
 .addComponent(jLabel6)
 .addComponent(jLabel5))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
 .addComponent(jButton3, javax.swing.GroupLayout.DEFAULT_SIZE, 238, Short.MAX_VALUE)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
 .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, 238, Short.MAX_VALUE)
 .addComponent(sizebox, javax.swing.GroupLayout.Alignment.TRAILING)
 .addComponent(qtybox)
 .addComponent(pricebox)
 .addComponent(productnamebox)
 .addComponent(productidbox)
 .addComponent(categorybox, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
 .addComponent(subcategorybox, 0, 238, Short.MAX_VALUE)))
 .addGap(18, 18, 18)
 .addComponent(jButton2)
 .addContainerGap(117, Short.MAX_VALUE))
 );
 layout.setVerticalGroup(
 layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(layout.createSequentialGroup()
 .addGap(92, 92, 92)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(jLabel2)
 .addComponent(categorybox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(jLabel3)
 .addComponent(subcategorybox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(productidbox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
 .addComponent(jLabel1)
 .addComponent(jButton2))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addComponent(productnamebox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
 .addComponent(jLabel4))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addComponent(jLabel5)
 .addComponent(pricebox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(18, 18, 18)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addComponent(jLabel6)
 .addComponent(qtybox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 9, Short.MAX_VALUE)
 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(jLabel7)
 .addComponent(sizebox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(18, 18, 18)
 .addComponent(jButton1)
 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
 .addComponent(jButton3)
 .addGap(52, 52, 52))
 );

 pack();
 }// </editor-fold> 

 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) { 
 
 
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="update producttable set productname=?, "
 + "price=?, qty=?, size=?, category=?, subcategory=? "
 + "where productid=?";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 
 mystatement.setString(7, productidbox.getText());
 mystatement.setString(1, productnamebox.getText());
 mystatement.setString(2, pricebox.getText());
 mystatement.setString(3, qtybox.getText());
 mystatement.setString(4, sizebox.getText());
 mystatement.setString(5, categorybox.getSelectedItem().toString());
 mystatement.setString(6, subcategorybox.getSelectedItem().toString());
 
 if(mystatement.executeUpdate()>0)
 {
 JOptionPane.showMessageDialog(rootPane,"Updated Successfully");
 
 
 }
 else
 {
 JOptionPane.showMessageDialog(rootPane,"Sorry, some problem occured");
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 
 
 } 

 private void categoryboxActionPerformed(java.awt.event.ActionEvent evt) { 
 
 if(categorybox.getSelectedIndex()>0)
 {
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="select subcatname from subcategorytable where catname=?";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 mystatement.setString(1, categorybox.getSelectedItem().toString());
 ResultSet myresult=mystatement.executeQuery();
 
 if(myresult.next())
 {
 subcategorybox.removeAllItems();
 subcategorybox.addItem("Choose Sub Category Now");
 do
 {
 subcategorybox.addItem(myresult.getString("subcatname"));
 }
 while(myresult.next());
 
 }
 else
 {
 JOptionPane.showMessageDialog(rootPane,"No Sub Categories exist");
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 
 }
 
 
 
 
 
 } 

 private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) { 
 
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="select * from producttable where productid=?";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 mystatement.setString(1, productidbox.getText());
 ResultSet myresult=mystatement.executeQuery();
 
 if(myresult.next())
 {
 productnamebox.setText(myresult.getString("productname"));
 qtybox.setText(myresult.getString("qty"));
 sizebox.setText(myresult.getString("size"));
 pricebox.setText(myresult.getString("price")); 
 categorybox.setSelectedItem(myresult.getString("category"));
 subcategorybox.setSelectedItem(myresult.getString("subcategory"));
 }
 else
 {
 JOptionPane.showMessageDialog(rootPane,"Wrong Product ID");
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 
 
 
 
 
 
 
 
 } 

 private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) { 

 int answer = JOptionPane.showConfirmDialog(rootPane, 
 "Do you really want to delete?", "Are you sure?", 
 JOptionPane.YES_NO_OPTION, JOptionPane.ERROR_MESSAGE);
 
 if(answer==JOptionPane.YES_OPTION)
 {
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="delete from producttable where productid=?";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 mystatement.setString(1, productidbox.getText());
 
 if(mystatement.executeUpdate()>0)
 {
 JOptionPane.showMessageDialog(rootPane,"Deleted Successfully");
 productnamebox.setText("");
 categorybox.setSelectedIndex(0);
 } 
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 }
 
 
 
 
 } 

