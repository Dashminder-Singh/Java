package hardware_shop;

import static hardware_shop.myvariables.PASSWORD;
import static hardware_shop.myvariables.PATH;
import static hardware_shop.myvariables.PLACE;
import static hardware_shop.myvariables.USERNAME;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.swing.JOptionPane;

/**
 *
 * @author GTB Projector Room
 */
public class Login extends javax.swing.JFrame {

 /**
 * Creates new form createadmin
 */
 public Login() {
 initComponents();
 }

 /**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
 @SuppressWarnings("unchecked")
 // <editor-fold defaultstate="collapsed" desc="Generated Code"> 
 private void initComponents() {

 jPanel1 = new javax.swing.JPanel();
 jLabel1 = new javax.swing.JLabel();
 jLabel2 = new javax.swing.JLabel();
 usernamebox = new javax.swing.JTextField();
 passwordbox = new javax.swing.JPasswordField();
 jButton1 = new javax.swing.JButton();

 setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

 jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

 jLabel1.setText("Username");

 jLabel2.setText("Password");

 jButton1.setText("Login");
 jButton1.addActionListener(new java.awt.event.ActionListener() {
 public void actionPerformed(java.awt.event.ActionEvent evt) {
 jButton1ActionPerformed(evt);
 }
 });

 javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
 jPanel1.setLayout(jPanel1Layout);
 jPanel1Layout.setHorizontalGroup(
 jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(jPanel1Layout.createSequentialGroup()
 .addGap(83, 83, 83)
 .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
 .addGroup(jPanel1Layout.createSequentialGroup()
 .addComponent(jLabel1)
 .addGap(18, 18, 18)
 .addComponent(usernamebox, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGroup(jPanel1Layout.createSequentialGroup()
 .addComponent(jLabel2)
 .addGap(18, 18, 18)
 .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
 .addComponent(passwordbox))))
 .addContainerGap(66, Short.MAX_VALUE))
 );
 jPanel1Layout.setVerticalGroup(
 jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(jPanel1Layout.createSequentialGroup()
 .addGap(56, 56, 56)
 .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(jLabel1)
 .addComponent(usernamebox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(22, 22, 22)
 .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
 .addComponent(jLabel2)
 .addComponent(passwordbox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
 .addGap(18, 18, 18)
 .addComponent(jButton1)
 .addContainerGap(59, Short.MAX_VALUE))
 );

 javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
 getContentPane().setLayout(layout);
 layout.setHorizontalGroup(
 layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
 .addContainerGap(81, Short.MAX_VALUE)
 .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
 .addGap(49, 49, 49))
 );
 layout.setVerticalGroup(
 layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
 .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
 .addContainerGap(56, Short.MAX_VALUE)
 .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
 .addGap(48, 48, 48))
 );

 pack();
 setLocationRelativeTo(null);
 }// </editor-fold> 

 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) { 
 
 
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="select * from usertable where username=? "
 + "and password=?";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 
 mystatement.setString(1, usernamebox.getText());
 mystatement.setString(2, passwordbox.getText());
 
 ResultSet myresult=mystatement.executeQuery();
 
 if(myresult.next())
 { 
 if(myresult.getString("usertype").equals("Admin"))
 {
 parentFrame obj=new parentFrame();
 obj.setVisible(true);
 obj.setExtendedState(MAXIMIZED_BOTH);
 }
 else 
 {
 empParentFrame obj=new empParentFrame();
 obj.setVisible(true);
 obj.setExtendedState(MAXIMIZED_BOTH);
 }
 
 this.dispose();
 
 }
 else
 {
 JOptionPane.showMessageDialog(rootPane,"Wrong username/password");
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(rootPane, "Error in Connection due to " + e.getMessage());
 }
 
 
 
 
 
 
 
 
 
 
 } 

 /**
 * @param args the command line arguments
 */
 public static void main(String args[]) {
 /* Set the Nimbus look and feel */
 //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
 /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
 * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
 */
 try {
 for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
 if ("Nimbus".equals(info.getName())) {
 javax.swing.UIManager.setLookAndFeel(info.getClassName());
 break;
 }
 }
 } catch (ClassNotFoundException ex) {
 java.util.logging.Logger.getLogger(Login.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
 } catch (InstantiationException ex) {
 java.util.logging.Logger.getLogger(Login.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
 } catch (IllegalAccessException ex) {
 java.util.logging.Logger.getLogger(Login.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
 } catch (javax.swing.UnsupportedLookAndFeelException ex) {
 java.util.logging.Logger.getLogger(Login.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
 }
 //</editor-fold>
 //</editor-fold>

 /* Create and display the form */
 java.awt.EventQueue.invokeLater(new Runnable() {
 public void run() {
 new Login().setVisible(true);
 }
 });
 }

 // Variables declaration - do not modify 
 private javax.swing.JButton jButton1;
 private javax.swing.JLabel jLabel1;
 private javax.swing.JLabel jLabel2;
 private javax.swing.JPanel jPanel1;
 private javax.swing.JPasswordField passwordbox;
 private javax.swing.JTextField usernamebox;
 // End of variables declaration 
}

==========================================================================


package hardware_shop;

import static hardware_shop.myvariables.PASSWORD;
import static hardware_shop.myvariables.PATH;
import static hardware_shop.myvariables.PLACE;
import static hardware_shop.myvariables.USERNAME;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.swing.JOptionPane;

public class mymain {

 
 public static void main(String[] args) {
 
 try {
 for (javax.swing.UIManager.LookAndFeelInfo info : 
 javax.swing.UIManager.getInstalledLookAndFeels()) {
 if ("Nimbus".equals(info.getName())) {
 javax.swing.UIManager.setLookAndFeel(info.getClassName());
 break;
 }
 }
 } catch (Exception ex) {
 JOptionPane.showMessageDialog(null, "Cannot apply nimbus theme");
 }
 
 
 try
 {
 Connection myconnection = DriverManager.getConnection(PATH+PLACE, USERNAME,PASSWORD); 
 
 try
 {
 String myquery="select * from usertable";
 PreparedStatement mystatement = myconnection.prepareStatement(myquery);
 
 ResultSet myresult=mystatement.executeQuery();
 
 if(myresult.next())
 { 
 Login obj=new Login();
 obj.setVisible(true); 
 
 }
 else
 {
 JOptionPane.showMessageDialog(null, "Running software first time, please create admin account");
 createadmin obj=new createadmin();
 obj.setVisible(true);
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(null, "Error in Query due to " + e.getMessage());
 }
 finally
 {
 myconnection.close();
 }
 }
 catch(Exception e)
 {
 JOptionPane.showMessageDialog(null, "Error in Connection due to " + e.getMessage());
 }
 }
 
}
